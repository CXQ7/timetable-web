{"remainingRequest":"E:\\timeline_web\\timetable-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\timeline_web\\timetable-web\\src\\views\\course-scheduling\\SaveCourseScheduling.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\timeline_web\\timetable-web\\src\\views\\course-scheduling\\SaveCourseScheduling.vue","mtime":1751427955402},{"path":"E:\\timeline_web\\timetable-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1751360460506},{"path":"E:\\timeline_web\\timetable-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1751360462610},{"path":"E:\\timeline_web\\timetable-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1751360460506},{"path":"E:\\timeline_web\\timetable-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1751360508429}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCcNCmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4Jw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdTYXZlQ291cnNlU2NoZWR1bGluZycsDQogIHByb3BzOiB7DQogICAgdmlzaWJsZTogew0KICAgICAgdHlwZTogQm9vbGVhbg0KICAgIH0sDQogICAgZGF0ZTogU3RyaW5nLA0KICAgIGF0dGVuZFRpbWU6IFN0cmluZw0KICB9LA0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICBjbGFzc3Jvb21EYXRhOiBbXSwNCiAgICAgIGNvdXJzZURhdGE6IFtdLA0KICAgICAgdGVhY2hlckRhdGE6IFtdLA0KICAgICAgZm9ybToge30sDQogICAgICBjdXJyZW50Q291cnNlOiB7fSwNCiAgICAgIGNvdXJzZUR1cmF0aW9uOiAwLA0KICAgICAgYXR0ZW5kVGltZVNlbGVjdEtleTogbmV3IERhdGUoKS5nZXRUaW1lKCksDQogICAgICBwaWNrZXJPcHRpb25zOiB7DQogICAgICAgIHN0YXJ0OiAnMDc6MDAnLA0KICAgICAgICBzdGVwOiAnMDA6JyArIHRoaXMuJGNvbnN0cy5DT1VSU0VfRFVSQVRJT05fU1RFUF9NSU5VVEUsDQogICAgICAgIGVuZDogJzIwOjAwJw0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIGRhdGU6IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICfml6XmnJ/kuI3og73kuLrnqbonLA0KICAgICAgICAgICAgdHJpZ2dlcjogJ2JsdXInDQogICAgICAgICAgfQ0KICAgICAgICBdLA0KICAgICAgICBjbGFzc3Jvb21JZDogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgICAgbWVzc2FnZTogJ+aVmeWupOS4jeiDveS4uuepuicsDQogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicNCiAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgIGNvdXJzZUlkOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgICBtZXNzYWdlOiAn6K++56iL5LiN6IO95Li656m6JywNCiAgICAgICAgICAgIHRyaWdnZXI6ICdibHVyJw0KICAgICAgICAgIH0NCiAgICAgICAgXSwNCiAgICAgICAgdGVhY2hlcklkOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgICBtZXNzYWdlOiAn6ICB5biI5LiN6IO95Li656m6JywNCiAgICAgICAgICAgIHRyaWdnZXI6ICdibHVyJw0KICAgICAgICAgIH0NCiAgICAgICAgXSwNCiAgICAgICAgYXR0ZW5kVGltZTogWw0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICAgICAgbWVzc2FnZTogJ+S4iuivvuaXtumXtOS4jeiDveS4uuepuicsDQogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicNCiAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgIGZpbmlzaFRpbWU6IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICfkuIvor77ml7bpl7TkuI3og73kuLrnqbonLA0KICAgICAgICAgICAgdHJpZ2dlcjogJ2JsdXInDQogICAgICAgICAgfQ0KICAgICAgICBdDQogICAgICB9LA0KICAgICAgc3VibWl0QnRuTG9hZGluZzogZmFsc2UNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAuLi5tYXBBY3Rpb25zKFsnR2V0Q2xhc3Nyb29tUmVmTGlzdCcsICdHZXRDb3Vyc2VSZWZMaXN0JywgJ0dldFRlYWNoZXJSZWZMaXN0JywgJ1NhdmVDb3Vyc2VTY2hlZHVsaW5nJ10pLA0KICAgIGluaXQgKCkgew0KICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybSwgJ2RhdGUnLCB0aGlzLmRhdGUpDQogICAgICB0aGlzLiRzZXQodGhpcy5mb3JtLCAnYXR0ZW5kVGltZScsIHRoaXMuYXR0ZW5kVGltZSkNCiAgICAgIHRoaXMuYXR0ZW5kVGltZVNlbGVjdEtleSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpDQogICAgICB0aGlzLkdldENsYXNzcm9vbVJlZkxpc3QoKS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMpIHsNCiAgICAgICAgICB0aGlzLmNsYXNzcm9vbURhdGEgPSByZXMNCiAgICAgICAgfQ0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgfSkNCiAgICAgIHRoaXMuR2V0Q291cnNlUmVmTGlzdCgpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcykgew0KICAgICAgICAgIHRoaXMuY291cnNlRGF0YSA9IHJlcw0KICAgICAgICB9DQogICAgICB9KS5jYXRjaCgoKSA9PiB7DQogICAgICB9KQ0KICAgICAgdGhpcy5HZXRUZWFjaGVyUmVmTGlzdCgpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcykgew0KICAgICAgICAgIHRoaXMudGVhY2hlckRhdGEgPSByZXMNCiAgICAgICAgfQ0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgfSkNCiAgICB9LA0KICAgIHJlc2V0RGF0YSAoKSB7DQogICAgICB0aGlzLiRyZWZzLmZvcm0ucmVzZXRGaWVsZHMoKQ0KICAgICAgdGhpcy5mb3JtID0ge30NCiAgICAgIHRoaXMuY291cnNlRHVyYXRpb24gPSAwDQogICAgICB0aGlzLmN1cnJlbnRDb3Vyc2UgPSB7fQ0KICAgICAgdGhpcy5jbGFzc3Jvb21EYXRhID0gW10NCiAgICAgIHRoaXMuY291cnNlRGF0YSA9IFtdDQogICAgICB0aGlzLnRlYWNoZXJEYXRhID0gW10NCiAgICB9LA0KICAgIGhhbmRsZUNsb3NlIChkb25lKSB7DQogICAgICB0aGlzLnJlc2V0RGF0YSgpDQogICAgICB0aGlzLiRlbWl0KCdvbi1jbG9zZScpDQogICAgICBkb25lKCkNCiAgICB9LA0KICAgIGNsb3NlICgpIHsNCiAgICAgIHRoaXMucmVzZXREYXRhKCkNCiAgICAgIHRoaXMuJGVtaXQoJ29uLWNsb3NlJykNCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlDQogICAgfSwNCiAgICBzdWJtaXQgKCkgew0KICAgICAgdGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKHZhbGlkID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgdGhpcy5zdWJtaXRCdG5Mb2FkaW5nID0gdHJ1ZQ0KICAgICAgICAgIHRoaXMuZm9ybS5hdHRlbmRUaW1lID0gbW9tZW50KHRoaXMuZm9ybS5hdHRlbmRUaW1lLCAnSEg6bW0nKS5mb3JtYXQoJ0hIOm1tOnNzJykNCiAgICAgICAgICB0aGlzLmZvcm0uZmluaXNoVGltZSA9IG1vbWVudCh0aGlzLmZvcm0uZmluaXNoVGltZSwgJ0hIOm1tJykuZm9ybWF0KCdISDptbTpzcycpDQogICAgICAgICAgdGhpcy5TYXZlQ291cnNlU2NoZWR1bGluZyh0aGlzLmZvcm0pLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5zdWJtaXRCdG5Mb2FkaW5nID0gZmFsc2UNCiAgICAgICAgICAgIHRoaXMucmVzZXREYXRhKCkNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ29uLXN1Y2Nlc3MnKQ0KICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UNCiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICB0aGlzLmZvcm0uYXR0ZW5kVGltZSA9IG1vbWVudCh0aGlzLmZvcm0uYXR0ZW5kVGltZSwgJ0hIOm1tOnNzJykuZm9ybWF0KCdISDptbScpDQogICAgICAgICAgICB0aGlzLmZvcm0uZmluaXNoVGltZSA9IG1vbWVudCh0aGlzLmZvcm0uZmluaXNoVGltZSwgJ0hIOm1tOnNzJykuZm9ybWF0KCdISDptbScpDQogICAgICAgICAgICB0aGlzLnN1Ym1pdEJ0bkxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBjb3Vyc2VDaGFuZ2UgKHZhbCkgew0KICAgICAgdGhpcy5mb3JtLmNvdXJzZUlkID0gdmFsLmlkDQogICAgICBpZiAodmFsLmR1cmF0aW9uICYmIHZhbC5kdXJhdGlvbiA+IDApIHsNCiAgICAgICAgdGhpcy5jb3Vyc2VEdXJhdGlvbiA9IHZhbC5kdXJhdGlvbg0KICAgICAgICBpZiAodGhpcy5mb3JtLmF0dGVuZFRpbWUpIHsNCiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtLCAnZmluaXNoVGltZScsIG1vbWVudCh0aGlzLmZvcm0uYXR0ZW5kVGltZSwgJ0hIOm1tJykuYWRkKHRoaXMuY291cnNlRHVyYXRpb24sICdtJykuZm9ybWF0KCdISDptbScpKQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBjYWxjRmluaXNoVGltZSAoKSB7DQogICAgICBpZiAodGhpcy5mb3JtLmF0dGVuZFRpbWUpIHsNCiAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybSwgJ2ZpbmlzaFRpbWUnLCBtb21lbnQodGhpcy5mb3JtLmF0dGVuZFRpbWUsICdISDptbScpLmFkZCh0aGlzLmNvdXJzZUR1cmF0aW9uLCAnbScpLmZvcm1hdCgnSEg6bW0nKSkNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIHdhdGNoOiB7DQogICAgdmlzaWJsZSAodmFsKSB7DQogICAgICBpZiAodmFsKSB7DQogICAgICAgIHRoaXMuaW5pdCgpDQogICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHZhbA0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["SaveCourseScheduling.vue"],"names":[],"mappings":";AAgEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SaveCourseScheduling.vue","sourceRoot":"src/views/course-scheduling","sourcesContent":["<template>\r\n  <el-dialog title=\"新增\" width=\"790px\"\r\n             :close-on-click-modal=\"false\"\r\n             :close-on-press-escape=\"false\"\r\n             :visible.sync=\"dialogVisible\"\r\n             :before-close=\"handleClose\" >\r\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" inline label-width=\"80px\" class=\"tams-form-container\">\r\n      <el-form-item label=\"日期\" prop=\"date\">\r\n        <el-input v-model=\"form.date\" class=\"tams-form-item\" disabled></el-input>\r\n      </el-form-item>\r\n      <br/>\r\n      <el-form-item label=\"教室\" prop=\"classroomId\">\r\n        <el-select v-model=\"form.classroomId\" class=\"tams-form-item\">\r\n          <el-option v-for=\"item in classroomData\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <br/>\r\n      <el-form-item label=\"课程\" prop=\"courseId\">\r\n        <el-select v-model=\"currentCourse\" value-key=\"id\" class=\"tams-form-item\" @change=\"courseChange\">\r\n          <el-option v-for=\"item in courseData\" :key=\"item.id\" :label=\"item.name\" :value=\"item\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"老师\" prop=\"teacherId\">\r\n        <el-select v-model=\"form.teacherId\" class=\"tams-form-item\">\r\n          <el-option v-for=\"item in teacherData\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"时间\" prop=\"attendTime\">\r\n        <el-time-select :clearable=\"false\"\r\n                        style=\"width: 210px;\"\r\n                        v-model=\"form.attendTime\"\r\n                        :disabled=\"!(form.courseId&&form.courseId>0)\"\r\n                        :picker-options=\"pickerOptions\"\r\n                        :key=\"attendTimeSelectKey\"\r\n                        @change=\"calcFinishTime\">\r\n        </el-time-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-input-number v-model=\"courseDuration\"\r\n                         style=\"width: 150px;\"\r\n                         :step=\"$consts.COURSE_DURATION_STEP_MINUTE\"\r\n                         :min=\"0\"\r\n                         :max=\"360\"\r\n                         :disabled=\"!(form.courseId&&form.courseId>0)\"\r\n                         @change=\"calcFinishTime\"></el-input-number>\r\n      </el-form-item>\r\n      <el-form-item prop=\"finishTime\">\r\n        <el-input v-model=\"form.finishTime\"\r\n                  :disabled=\"!(form.courseId&&form.courseId>0)\"\r\n                  readonly\r\n                  style=\"width: 210px;\"></el-input>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n      <el-button @click=\"close\">取消</el-button>\r\n      <el-button type=\"primary\" :loading=\"submitBtnLoading\" @click=\"submit\">确定</el-button>\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment'\r\nimport { mapActions } from 'vuex'\r\n\r\nexport default {\r\n  name: 'SaveCourseScheduling',\r\n  props: {\r\n    visible: {\r\n      type: Boolean\r\n    },\r\n    date: String,\r\n    attendTime: String\r\n  },\r\n  data () {\r\n    return {\r\n      dialogVisible: false,\r\n      classroomData: [],\r\n      courseData: [],\r\n      teacherData: [],\r\n      form: {},\r\n      currentCourse: {},\r\n      courseDuration: 0,\r\n      attendTimeSelectKey: new Date().getTime(),\r\n      pickerOptions: {\r\n        start: '07:00',\r\n        step: '00:' + this.$consts.COURSE_DURATION_STEP_MINUTE,\r\n        end: '20:00'\r\n      },\r\n      rules: {\r\n        date: [\r\n          {\r\n            required: true,\r\n            message: '日期不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        classroomId: [\r\n          {\r\n            required: true,\r\n            message: '教室不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        courseId: [\r\n          {\r\n            required: true,\r\n            message: '课程不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        teacherId: [\r\n          {\r\n            required: true,\r\n            message: '老师不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        attendTime: [\r\n          {\r\n            required: true,\r\n            message: '上课时间不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ],\r\n        finishTime: [\r\n          {\r\n            required: true,\r\n            message: '下课时间不能为空',\r\n            trigger: 'blur'\r\n          }\r\n        ]\r\n      },\r\n      submitBtnLoading: false\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions(['GetClassroomRefList', 'GetCourseRefList', 'GetTeacherRefList', 'SaveCourseScheduling']),\r\n    init () {\r\n      this.$set(this.form, 'date', this.date)\r\n      this.$set(this.form, 'attendTime', this.attendTime)\r\n      this.attendTimeSelectKey = new Date().getTime()\r\n      this.GetClassroomRefList().then(res => {\r\n        if (res) {\r\n          this.classroomData = res\r\n        }\r\n      }).catch(() => {\r\n      })\r\n      this.GetCourseRefList().then(res => {\r\n        if (res) {\r\n          this.courseData = res\r\n        }\r\n      }).catch(() => {\r\n      })\r\n      this.GetTeacherRefList().then(res => {\r\n        if (res) {\r\n          this.teacherData = res\r\n        }\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    resetData () {\r\n      this.$refs.form.resetFields()\r\n      this.form = {}\r\n      this.courseDuration = 0\r\n      this.currentCourse = {}\r\n      this.classroomData = []\r\n      this.courseData = []\r\n      this.teacherData = []\r\n    },\r\n    handleClose (done) {\r\n      this.resetData()\r\n      this.$emit('on-close')\r\n      done()\r\n    },\r\n    close () {\r\n      this.resetData()\r\n      this.$emit('on-close')\r\n      this.dialogVisible = false\r\n    },\r\n    submit () {\r\n      this.$refs.form.validate(valid => {\r\n        if (valid) {\r\n          this.submitBtnLoading = true\r\n          this.form.attendTime = moment(this.form.attendTime, 'HH:mm').format('HH:mm:ss')\r\n          this.form.finishTime = moment(this.form.finishTime, 'HH:mm').format('HH:mm:ss')\r\n          this.SaveCourseScheduling(this.form).then(() => {\r\n            this.submitBtnLoading = false\r\n            this.resetData()\r\n            this.$emit('on-success')\r\n            this.dialogVisible = false\r\n          }).catch(() => {\r\n            this.form.attendTime = moment(this.form.attendTime, 'HH:mm:ss').format('HH:mm')\r\n            this.form.finishTime = moment(this.form.finishTime, 'HH:mm:ss').format('HH:mm')\r\n            this.submitBtnLoading = false\r\n          })\r\n        }\r\n      })\r\n    },\r\n    courseChange (val) {\r\n      this.form.courseId = val.id\r\n      if (val.duration && val.duration > 0) {\r\n        this.courseDuration = val.duration\r\n        if (this.form.attendTime) {\r\n          this.$set(this.form, 'finishTime', moment(this.form.attendTime, 'HH:mm').add(this.courseDuration, 'm').format('HH:mm'))\r\n        }\r\n      }\r\n    },\r\n    calcFinishTime () {\r\n      if (this.form.attendTime) {\r\n        this.$set(this.form, 'finishTime', moment(this.form.attendTime, 'HH:mm').add(this.courseDuration, 'm').format('HH:mm'))\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    visible (val) {\r\n      if (val) {\r\n        this.init()\r\n        this.dialogVisible = val\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}